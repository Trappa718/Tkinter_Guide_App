import tkinter as tk
import time

class Stopwatch:
    def __init__(self, root):
        self.root = root
        self.root.title("Секундомер")
        self.root.geometry("400x500")
        
        self.running = False
        self.start_time = 0
        self.elapsed_time = 0
        self.laps = []
        
        self.create_widgets()
    
    def create_widgets(self):
        """Создание интерфейса"""
        # Дисплей времени
        self.time_display = tk.Label(self.root, text="00:00:00.0", 
                                    font=("Courier New", 32, "bold"))
        self.time_display.pack(pady=30)
        
        # Фрейм для кнопок управления
        control_frame = tk.Frame(self.root)
        control_frame.pack(pady=20)
        
        self.start_button = tk.Button(control_frame, text="Старт", 
                                     command=self.start, font=("Arial", 12),
                                     bg="lightgreen", width=8)
        self.start_button.pack(side=tk.LEFT, padx=5)
        
        self.stop_button = tk.Button(control_frame, text="Стоп", 
                                    command=self.stop, font=("Arial", 12),
                                    bg="lightcoral", width=8)
        self.stop_button.pack(side=tk.LEFT, padx=5)
        
        self.reset_button = tk.Button(control_frame, text="Сброс", 
                                     command=self.reset, font=("Arial", 12),
                                     bg="lightyellow", width=8)
        self.reset_button.pack(side=tk.LEFT, padx=5)
        
        self.lap_button = tk.Button(control_frame, text="Круг", 
                                   command=self.record_lap, font=("Arial", 12),
                                   bg="lightblue", width=8)
        self.lap_button.pack(side=tk.LEFT, padx=5)
        
        # Список кругов
        tk.Label(self.root, text="Круги:", font=("Arial", 12, "bold")).pack(pady=10)
        
        self.lap_listbox = tk.Listbox(self.root, font=("Courier New", 10), height=10)
        self.lap_listbox.pack(pady=10, padx=20, fill=tk.BOTH, expand=True)
        
        # Полоса прокрутки для списка
        scrollbar = tk.Scrollbar(self.lap_listbox)
        scrollbar.pack(side=tk.RIGHT, fill=tk.Y)
        self.lap_listbox.config(yscrollcommand=scrollbar.set)
        scrollbar.config(command=self.lap_listbox.yview)
    
    def start(self):
        """Запуск секундомера"""
        if not self.running:
            self.running = True
            self.start_time = time.time() - self.elapsed_time
            self.update_time()
    
    def stop(self):
        """Остановка секундомера"""
        self.running = False
    
    def reset(self):
        """Сброс секундомера"""
        self.running = False
        self.elapsed_time = 0
        self.laps = []
        self.lap_listbox.delete(0, tk.END)
        self.time_display.config(text="00:00:00.0")
    
    def record_lap(self):
        """Запись круга"""
        if self.running:
            lap_time = self.format_time(self.elapsed_time)
            lap_number = len(self.laps) + 1
            self.laps.append(lap_time)
            self.lap_listbox.insert(tk.END, f"Круг {lap_number}: {lap_time}")
    
    def update_time(self):
        """Обновление отображения времени"""
        if self.running:
            self.elapsed_time = time.time() - self.start_time
            formatted_time = self.format_time(self.elapsed_time)
            self.time_display.config(text=formatted_time)
            self.root.after(100, self.update_time)  # Обновляем каждые 100мс
    
    def format_time(self, seconds):
        """Форматирование времени в MM:SS:MS"""
        minutes = int(seconds // 60)
        seconds = seconds % 60
        millis = int((seconds - int(seconds)) * 10)
        return f"{minutes:02d}:{int(seconds):02d}.{millis}"

# Запуск секундомера
root = tk.Tk()
stopwatch = Stopwatch(root)
root.mainloop()